---
import { Image } from 'astro:assets'
import { getCollection, getEntryBySlug } from 'astro:content'
import Page from '@/layouts/page.astro'
import { Gallery } from '@/components/gallery'
import { buttonVariants } from '@/components/ui/button'
import meUrl from '@/assets/me.jpg'
import { getImageWithBlurhash } from '@/lib/images'
import ProjectCard from '@/components/project-card.astro'
import ImageWithBlurhash from '@/components/image-with-blurhash.astro'

const pics = await getCollection('pics')
const galleryItems = await Promise.all(
  pics.map(pic => getImageWithBlurhash(pic.data))
)

const projects = await Promise.all([
  getEntryBySlug('projects', 'full-stack-typescript'),
  getEntryBySlug('projects', 'rug-design-portal'),
])
---

<Page>
  <main class="container mx-auto">
    <section
      class="pt-24 pb-20 flex flex-col-reverse md:flex-row justify-between gap-2"
    >
      <div>
        <header>
          <h1 class="text-4xl font-extrabold">Luke Rucker</h1>
        </header>

        <p class="mt-5 mb-2 text-muted-foreground">
          Freelance dev building for the web. Typescript fanboy. Cyclist.
        </p>

        <a
          href="https://www.google.com/maps/place/Cambridge,+MA"
          target="_blank"
          class="text-muted-foreground text-sm"
        >
          <i data-lucide="globe" class="h-5 w-5 inline mr-1.5"></i><span
            class="hover:underline">Cambridge, MA, EST</span
          >
        </a>

        <footer class="mt-6 space-x-2">
          <a
            href="mailto:me@lukerucker.com"
            class={buttonVariants({ variant: 'default' })}
            >Say Hi <i data-lucide="mail" class="ml-2 h-5 w-5 inline"></i></a
          >

          <a href="/about" class={buttonVariants({ variant: 'secondary' })}
            >Learn More <i data-lucide="arrow-right" class="ml-2 h-5 w-5 inline"
            ></i></a
          >
        </footer>
      </div>

      <ImageWithBlurhash
        src={meUrl}
        alt="Me, Luke Rucker."
        className="h-64 w-64"
      />
    </section>
  </main>

  <section class="mb-20">
    <header>
      <h2>
        <span class="sr-only">Gallery</span>
      </h2>

      <p class="sr-only">Some pictures I've taken. Shot on my iPhone 13 Pro.</p>

      <Gallery items={galleryItems} client:load />
    </header>
  </section>

  <section class="container mx-auto mb-20">
    <header class="mb-4">
      <h2 class="text-2xl font-semibold">What I do</h2>

      <p class="mt-3 text-muted-foreground">
        I currently work as a <b>freelancer</b> doing full stack web dev for different
        stages of teams and products. I particuarly enjoy the challenges of working
        with small teams, taking a product from idea to the world. Working on small
        teams has afforded me the chance to do a variety of roles; I've been the
        <b>manager of the dev team</b>, the product analytics guy, <b
          >the slinger of code</b
        >, or whatever is required of me.
      </p>
    </header>

    <h3 class="text-xl font-semibold mb-7">Projects</h3>
    <ul class="space-y-6">
      {
        projects.map(project => (
          <li>
            <ProjectCard project={project} />
          </li>
        ))
      }
    </ul>

    <footer class="mt-7">
      <a href="/work" class="underline"> View All</a>
    </footer>
  </section>
</Page>
